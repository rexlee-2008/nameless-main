from concurrent.futures import ThreadPoolExecutor, as_completed
from Crypto.Util.number import inverse, long_to_bytes
from sympy import factorint

# 주어진 값들
e = 65537
c1 = 381069285100501871522087811493550905198188960030751325118473292211721172724945400851753896037004606245416539933976144394979158631237671756909066247247948657455463544370978705281106076582936920059839389639324602559885258011506319919444034559534161629591362838114040811027316110122399760193317706368614091049552410153189126777046775531348995841633603915743870982717512900837715408697220152656945042833613130640604201878636782124578056677959713510522729201148873058100021433527643925404508372293838761493245193523300633811142677155050909169204237034111744335148069413991638567324485404779032807774024268683800248849305245158551014474667378084785353996087326905760046021519173564654262068228543060770224035401472305016440034107419937276452606743360092602145817996522605693522170574104072149289934130651578954382892812930560547375012607952007386098221328133681604521057092328956919768459413704775366733492106940290228897291407667073215842645582680094802781728265146676458960343970806963121253297554819744302905292070292300725362914290724183949474138147950909314365183897991947821426922965681115837438882479870511141154709033470889637694265305456662747715495015790021616624574060669895147696535390744429693577809258663966840165386993435407
c2 = 189067567513924361366841896403262862290852818934133552091223969376176842756133065184300343876378351342482398809757435596016656900573073161917379304331850007350704157392160586916533123270174140945354274212194179979653836191893130697458038530838405888127138844324772849097679116321750629080533886807420776765783941746172847831709553753006201417688728652298440697987317301855151730703703573635905882849810271134252070214368840079159389831043324643656295121177074278151076444507043284743210746646988738929938156504512240984412509205938974747552402407497421567966974824575765305251022421356985862385030348535458938858844901708520023408264985492901173877077175801005221163408655778666007241201808107485677030169130305243857752266595943639103168587096284649025674954539315353048669782392048875595639610664020410369075734789773608666125542063040732626453700969601790271924006790956175327921865531481168229889323603339035825361151830912759620097238533560817386375684965176594881676677306605042527530502146671644450958838782505080700430779435150081216067636225765101597810641167753096126000722960971877550528539845565787851101340275515309771722486035069873896866643709391742761133938205666074545421157439002945584201532020248894119434541703269

# n1, n2 주어진 값
n1 = 530714464609988271379319666168008787570512864834415117957831465100894605318124415501152436678455072997404896888952461857283907130382344972917483604782406322361362494119398114704910176714930872093510046884543231515887961468672614894089236238348146616740533769065755076838643609516986324166643827178750736404807856963177405819352341352036936604828586717197929121531682756050059264687530489601884380974589526409164528089971635388393186916816186037787781524716176288571931247769567954048144390415393154537987056253872782697992299600441589884470194747066442004537645877058890561216339379017397797132954484275658619508228887835060871526022843347877768829262073664499975108132768292714210915875453719942783772553633840011480625898945500272712886937811770715872865651625869691887391979055738960019189681747889257697505026462231992098290092786042362775735685733967646282597057077545915495889795125760993452054616355137136806134742285786513684594857372256770980482018266131245784137581659829455838715831415054857938751849616866275383294395512688095792069358806145187318552565766409549458634070177847764811182702710777163795221072332872661482354024201460632166855240700997920073679684861989423792661461371484993996596086616492901359185811689107

n2 = 666670054722277908885779357682581545047503559537049529344488649293171490098713841188823854772222757560987764289728630712712390997038482008057949285026364518079309223432457700721586019275093586229251981679376714543686195613617491115416239279477025160076502357451877687152025478772831123209087745471632615111024756262433719625922203295638888213055400752880673356273900937114023902284692522314697285457479897276978686395260475542701609219786139098396005070196230704919844781538790296041711080813501629924019292284696609256412963104525162135249999404609648345450194063250567461478165256991591172626759296399776267667958823430071680032490534256841476544429335435362445528929116891596228670394235873923106751022837976611593958546371515114753986049605844790338413799323922232867102999109835353570930691069408510912871328760058498967246927012227969746994578084829379172421450732922583459453739777322973062598135348799661667638013361076044091381103407017627914421781316129933650549694602329609003255356798176369656031354825041117506507557973582788852384198477277321845648698985979513347711568303152201384411425996090433858284727471201152327454064289589254685549383248009870418341370545081532634697964968103651905293674186034137704896376547413

def decrypt(n, c):
    # 소인수분해
    factors = factorint(n)
    p, q = factors.keys()

    # φ(n) 계산
    phi = (p - 1) * (q - 1)

    # d 계산
    d = inverse(e, phi)

    # 복호화
    m = pow(c, d, n)

    # 바이트로 변환
    return long_to_bytes(m)

# 병렬 처리
with ThreadPoolExecutor() as executor:
    futures = {
        executor.submit(decrypt, n1, c1): "Flag 1",
        executor.submit(decrypt, n2, c2): "Flag 2"
    }
    
    for future in as_completed(futures):
        flag = future.result()
        print(f"{futures[future]}: {flag}")
